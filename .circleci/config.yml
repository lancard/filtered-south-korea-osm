version: 2.1

orbs:
  node: circleci/node@4.7

jobs:
  build-and-test:
    docker:
      - image: cimg/node:16.10
    steps:
      - checkout
      - run:
          name: Download Korea pbf
          command: wget https://download.geofabrik.de/asia/south-korea-latest.osm.pbf
      - run:
          name: Filtering
          command: osmfilter32 south-korea-latest.osm --keep="water= highway=primary highway=motorway waterway= railway= natural=coastline narutal=peak aeroway=" > filtered.osm
      - run:
          name: Compress to pbf
          command: osmconvert64 filtered.osm -o=filtered.osm.pbf

workflows:
  south-korea:
    jobs:
      - build-and-test
